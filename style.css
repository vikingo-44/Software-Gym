/* =================================================================
   ESTILOS ORIGINALES (DESKTOP / BASE)
   ================================================================= */
body {
    font-family: 'Inter', sans-serif;
    background-color: #000000;
    background-image: linear-gradient(rgba(0, 0, 0, 0.94), rgba(0, 0, 0, 0.94)), url('https://images.unsplash.com/photo-1534438327276-14e5300c3a48?q=80&w=2070&auto=format&fit=crop');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    color: #ffffff;
    overflow: hidden; /* Se sobreescribe en móvil más abajo */
    touch-action: pan-x pan-y;
    -webkit-text-size-adjust: 100%;
}

.viking-red { color: #FF0000; }
.viking-bg-red { background-color: #FF0000; }

.glass-sidebar {
    background: rgba(8, 8, 8, 0.98);
    backdrop-filter: blur(40px);
    border-right: 1px solid rgba(255, 0, 0, 0.15);
    transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1), left 0.4s ease;
}

.glass-card {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.06);
    transition: all 0.3s ease;
}
.glass-card:hover { border-color: rgba(255, 0, 0, 0.3); background: rgba(255, 255, 255, 0.05); }

.logo-viking-glow {
    filter: drop-shadow(0 0 15px rgba(255, 0, 0, 0.6));
    animation: pulse-glow 3s infinite alternate;
}
@keyframes pulse-glow {
    from { filter: drop-shadow(0 0 5px rgba(255, 0, 0, 0.4)); transform: scale(1); }
    to { filter: drop-shadow(0 0 25px rgba(255, 0, 0, 0.8)); transform: scale(1.05); }
}

.nav-item { 
    display: flex !important;
    align-items: center !important;
    gap: 1.25rem !important; 
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
    position: relative; 
    white-space: nowrap; 
    text-align: left !important;
}
.nav-item:hover, .nav-item.active { 
    color: #FF0000; 
    background: linear-gradient(90deg, rgba(255, 0, 0, 0.1) 0%, transparent 100%);
}
.nav-item.active::before {
    content: ''; position: absolute; left: 0; top: 25%; height: 50%; width: 4px;
    background: #FF0000; box-shadow: 0 0 15px #FF0000;
}

.view-content { display: none; flex-direction: column; height: 100%; }
.view-content.active { display: flex; }

#login-overlay {
    position: fixed; inset: 0; z-index: 1000;
    background: black; display: flex; align-items: center; justify-content: center;
    background-image: linear-gradient(rgba(0,0,0,0.85), rgba(0,0,0,0.85)), url('https://images.unsplash.com/photo-1534438327276-14e5300c3a48?q=80&w=2070&auto=format&fit=crop');
    background-size: cover;
}

.custom-scrollbar::-webkit-scrollbar { width: 4px; }
.custom-scrollbar::-webkit-scrollbar-thumb { background: #FF0000; border-radius: 10px; }

.viking-table-row { border-bottom: 1px solid rgba(255, 255, 255, 0.03); transition: background 0.2s; }
.viking-table-row:hover { background: rgba(255, 0, 0, 0.02); }

.calendar-container { 
    display: grid; grid-template-columns: 50px repeat(6, 1fr); 
    background: rgba(255, 255, 255, 0.02); border-radius: 24px; overflow: hidden; 
    border: 1px solid rgba(255, 255, 255, 0.1); 
}
.cal-header { 
    background: rgba(255,0,0,0.15); 
    padding: 12px 4px; 
    text-align: center; 
    font-weight: 900; 
    font-size: 13px; 
    border-right: 1px solid rgba(255,255,255,0.1); 
    text-transform: uppercase; 
    letter-spacing: 1px; 
}
.cal-cell { 
    border-right: 1px solid rgba(255,255,255,0.1); 
    border-bottom: 1px solid rgba(255,255,255,0.1); 
    height: 50px; 
    position: relative; 
}
.cal-cell-closed { 
    background: repeating-linear-gradient(45deg, rgba(255,255,255,0.02), rgba(255,255,255,0.02) 10px, rgba(255,255,255,0.05) 10px, rgba(255,255,255,0.05) 20px); 
    opacity: 0.5; 
}

/* Sidebar Colapsada PC */
.sidebar-collapsed { width: 80px !important; }
.sidebar-collapsed .brand-text,
.sidebar-collapsed .user-details,
.sidebar-collapsed .nav-text,
.sidebar-collapsed .nav-section-title,
.sidebar-collapsed .chevron-icon { display: none; }
.sidebar-collapsed .nav-item { justify-content: center !important; padding-left: 0; padding-right: 0; gap: 0 !important; }

.sidebar-collapsed #user-avatar-container { 
    width: 40px !important; 
    height: 40px !important; 
    margin-bottom: 10px !important;
}
.sidebar-collapsed #user-initials { font-size: 14px !important; }
.sidebar-collapsed .user-profile-block { 
    padding-left: 0 !important; 
    padding-right: 0 !important; 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
}

.viking-input {
    background: rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 1rem;
    padding: 0.85rem 1.25rem;
    width: 100%;
    outline: none;
    font-weight: 700;
    font-size: 0.95rem;
    color: white;
    transition: all 0.2s;
}
.viking-input:focus { border-color: #FF0000; box-shadow: 0 0 10px rgba(255, 0, 0, 0.1); }
select.viking-input option { background: #0a0a0a; color: white; }

.viking-modal {
    position: fixed; inset: 0; z-index: 1000;
    background: rgba(0,0,0,0.9); backdrop-filter: blur(15px);
    display: none; align-items: center; justify-content: center;
    padding: 20px;
}

.class-badge { 
    color: black; 
    font-weight: 900; 
    padding: 4px; 
    text-transform: uppercase; 
    font-style: italic; 
    cursor: pointer; 
    display: flex; 
    flex-direction: column; 
    justify-content: center; 
    align-items: center; 
    text-align: center; 
    height: calc(200% + 1px); 
    width: calc(100% - 4px); 
    margin: 2px; 
    border-radius: 14px; 
    border: 1px solid rgba(255,255,255,0.3); 
    box-shadow: 0 4px 12px rgba(0,0,0,0.4); 
    position: absolute; 
    top: 0; 
    left: 0; 
    z-index: 20; 
    transition: all 0.2s;
}
.class-badge:hover { transform: scale(0.97); z-index: 20; }

.filter-btn {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #999;
    padding: 8px 16px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 900;
    text-transform: uppercase;
    font-style: italic;
    transition: all 0.3s;
}
.filter-btn.active { background: #FF0000; color: #000; border-color: #FF0000; }

.payment-method-btn {
    border: 1px solid rgba(255, 255, 255, 0.05);
    background: rgba(255, 255, 255, 0.02);
    transition: all 0.2s;
}
.payment-method-btn.active {
    border-color: #FF0000;
    background: rgba(255, 0, 0, 0.1);
    color: #FF0000;
}

.cobrar-tab {
    padding: 12px 24px;
    font-weight: 900;
    font-size: 11px;
    text-transform: uppercase;
    font-style: italic;
    border-bottom: 2px solid transparent;
    color: #666;
    transition: all 0.3s;
}
.cobrar-tab.active { border-bottom-color: #FF0000; color: #FF0000; }

.notification-toast {
    position: fixed; bottom: 30px; right: 30px;
    background: #FF0000; color: black;
    padding: 20px 40px; border-radius: 20px;
    font-weight: 900; text-transform: uppercase; font-style: italic;
    z-index: 2000; transform: translateY(150%);
    transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 10px 40px rgba(255, 0, 0, 0.4);
}
.notification-toast.show { transform: translateY(0); }

.multi-select-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    background: rgba(255,255,255,0.05);
    padding: 15px;
    border-radius: 15px;
    max-height: 150px;
    overflow-y: auto;
}
.multi-option {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 10px;
    font-weight: 900;
    text-transform: uppercase;
    cursor: pointer;
    padding: 8px;
    border-radius: 8px;
    background: rgba(0,0,0,0.3);
    border: 1px solid rgba(255,255,255,0.05);
}
.multi-option input { display: none; }
.multi-option:has(input:checked) {
    border-color: #FF0000;
    background: rgba(255,0,0,0.1);
    color: #FF0000;
}

.rutina-dia-card {
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.05);
    padding: 1.5rem;
    border-radius: 1.5rem;
    position: relative;
}
.exercise-grid {
    display: grid;
    grid-template-columns: 2.5fr 0.8fr 0.8fr 0.8fr 1fr 40px;
    gap: 12px;
    align-items: center;
}

.scanner-mask { box-shadow: 0 0 0 9999px rgb(0, 0, 0); }
@keyframes scan-line {
    0% { top: 0%; opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { top: 100%; opacity: 0; }
}
.animate-scan-line { animation: scan-line 2.5s linear infinite; }


/* =================================================================
   EXPERIENCIA APP NATIVA (MOBILE ONLY) - OPTIMIZADO
   ================================================================= */
@media (max-width: 1024px) {
    /* 1. RESET GLOBAL MÓVIL */
    * {
        -webkit-tap-highlight-color: transparent; /* Adiós al flash gris al tocar */
        touch-action: manipulation; /* Mejora la respuesta al click */
    }

    body {
        overflow-y: auto !important;
        overflow-x: hidden !important;
        /* Scroll suave tipo iOS */
        -webkit-overflow-scrolling: touch;
        overscroll-behavior-y: none; /* Evita que la página "rebote" entera */
    }

    /* 2. HEADER CON SAFE AREAS (NOTCH) */
    header {
        position: sticky;
        top: 0;
        z-index: 50;
        height: auto !important;
        min-height: 70px;
        padding-top: env(safe-area-inset-top) !important;
        padding-left: 16px !important;
        padding-right: 16px !important;
        background: rgba(0,0,0,0.95) !important;
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    /* 3. MENÚ LATERAL (DRAWER) */
    #sidebar {
        position: fixed;
        left: -100%; 
        top: 0;
        bottom: 0;
        z-index: 200;
        width: 85% !important;
        max-width: 320px;
        display: flex !important;
        flex-direction: column;
        background: #0a0a0a; /* Fondo sólido para rendimiento */
        padding-top: env(safe-area-inset-top);
        padding-bottom: env(safe-area-inset-bottom);
        transition: transform 0.3s cubic-bezier(0.25, 1, 0.5, 1);
        transform: translateX(0); /* Estado inicial controlado por left */
        border-right: 1px solid rgba(255,255,255,0.1);
    }

    #sidebar.mobile-open {
        left: 0;
        box-shadow: 100vw 0 0 rgba(0,0,0,0.8); /* Overlay hack con sombra */
    }
    
    .sidebar-overlay {
        display: none; /* Usamos la sombra del sidebar para el overlay visual */
    }

    /* 4. CONTENIDO PRINCIPAL */
    main {
        margin-left: 0 !important;
        width: 100% !important;
        padding-bottom: calc(100px + env(safe-area-inset-bottom));
        padding-top: 0 !important;
    }

    .view-content {
        padding: 16px !important;
    }

    /* 5. INPUTS: REGLA DE ORO ANTI-ZOOM */
    /* Fuente 16px evita que iOS haga zoom al input */
    .viking-input, input, select, textarea {
        font-size: 16px !important; 
        max-width: 100% !important;
        min-height: 48px; /* Altura cómoda para dedo */
        padding: 12px 16px;
        border-radius: 12px;
        appearance: none; /* Elimina estilos nativos feos */
        -webkit-appearance: none;
        background-color: #111 !important;
    }
    
    /* 6. MODALES: ESTILO BOTTOM SHEET (NATIVO) */
    .viking-modal {
        align-items: flex-end !important; /* Alineado abajo */
        padding: 0 !important;
        background: rgba(0,0,0,0.8);
        backdrop-filter: blur(5px);
    }

    .viking-modal > div {
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
        border-bottom-left-radius: 0 !important;
        border-bottom-right-radius: 0 !important;
        border-top-left-radius: 24px !important;
        border-top-right-radius: 24px !important;
        padding: 24px !important;
        padding-bottom: calc(24px + env(safe-area-inset-bottom)) !important;
        max-height: 85vh; /* Altura máxima controlada para que no sean gigantes */
        overflow-y: auto;
        border: none;
        border-top: 1px solid rgba(255,255,255,0.2);
        background: #111; /* Fondo sólido */
        animation: slide-up 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }

    @keyframes slide-up {
        from { transform: translateY(100%); }
        to { transform: translateY(0); }
    }

    /* 7. FEEDBACK TÁCTIL (BOTONES Y CARDS) */
    button:active, .glass-card:active, .nav-item:active {
        transform: scale(0.97);
        opacity: 0.9;
        transition: transform 0.1s;
    }

    /* 8. TABLAS COMO TARJETAS (CARD VIEW) */
    thead { display: none; } /* Ocultar encabezados tabla */
    
    tr {
        display: flex;
        flex-direction: column;
        background: rgba(255,255,255,0.03);
        border: 1px solid rgba(255,255,255,0.08);
        margin-bottom: 12px;
        padding: 16px;
        border-radius: 16px;
    }
    
    td {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0 !important;
        border-bottom: 1px solid rgba(255,255,255,0.05);
        text-align: right;
        font-size: 14px;
    }
    td:last-child { border-bottom: none; }

    /* 9. GRILLAS Y LAYOUTS A UNA COLUMNA */
    .grid-cols-2, .grid-cols-3, .grid-cols-4, .exercise-grid {
        grid-template-columns: 1fr !important;
        gap: 12px !important;
    }
    
    /* 10. CALENDARIO - HORIZONTAL SCROLL SNAP (TikTok Style) */
    /* Transformamos el grid vertical en un carrusel horizontal */
    .calendar-container {
        display: flex !important; /* No grid */
        overflow-x: auto !important;
        scroll-snap-type: x mandatory; /* Efecto imán */
        gap: 16px;
        padding-bottom: 20px;
        height: auto !important;
        background: transparent !important;
        border: none !important;
        grid-template-columns: none !important;
        /* Ocultar barra de scroll para limpieza */
        scrollbar-width: none; /* Firefox */
        -ms-overflow-style: none;  /* IE/Edge */
    }
    .calendar-container::-webkit-scrollbar {
        display: none; /* Chrome/Safari */
    }

    /* Cada Columna (Día) */
    .calendar-container > div {
        min-width: 85vw; /* Ocupa el 85% del ancho de pantalla */
        scroll-snap-align: center; /* Se centra al soltar */
        background: #0f0f0f;
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 24px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        height: 600px; /* Altura fija para scroll interno si necesario */
    }
    
    /* Encabezado del día (Sticky dentro de la columna) */
    .cal-header {
        position: sticky; top: 0; z-index: 10;
        background: #1a1a1a;
        padding: 15px;
        border-bottom: 1px solid #333;
        font-size: 14px;
    }
    
    /* Celdas horarias */
    .cal-cell {
        min-height: 80px; /* Más alto para dedos */
        border-right: none;
    }

    /* 11. BOTÓN HAMBURGUESA */
    .mobile-menu-trigger {
        display: flex !important;
        width: 44px;
        height: 44px;
        align-items: center;
        justify-content: center;
        background: rgba(255, 0, 0, 0.1);
        border: 1px solid rgba(255, 0, 0, 0.2);
        border-radius: 12px;
        color: #FF0000;
    }

    /* 12. AJUSTES VARIOS */
    .sidebar-collapsed { width: 0 !important; overflow: hidden; }
    
    /* Badges de clases mas grandes */
    .class-badge {
        position: relative;
        height: auto !important;
        min-height: 60px;
        width: 100%;
        margin: 4px 0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    /* Botones de acción más grandes */
    button {
        min-height: 48px;
    }
}

/* ESCONDER BOTÓN MENU EN PC */
@media (min-width: 1025px) {
    .mobile-menu-trigger { display: none !important; }
}